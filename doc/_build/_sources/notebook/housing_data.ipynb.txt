{
 "cells": [
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# Demo session\n",
    "A demo session to display the housing data scraped"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 1,
   "metadata": {},
   "outputs": [],
   "source": [
    "import pandas\n",
    "import datetime\n",
    "import pytz"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "metadata": {},
   "outputs": [],
   "source": [
    "now = datetime.datetime.now(tz=pytz.timezone(\"Asia/Kuala_Lumpur\"))\n",
    "json_file = f\"../data/{now:%Y-%m-%d}.json\""
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>type</th>\n",
       "      <th>id</th>\n",
       "      <th>attributes</th>\n",
       "      <th>links</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>ads</td>\n",
       "      <td>105113750</td>\n",
       "      <td>{'date': '2024-02-05 02:16:50', 'modified_ts':...</td>\n",
       "      <td>{'image_baseurl': 'https://img.rnudah.com/imag...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>ads</td>\n",
       "      <td>105069635</td>\n",
       "      <td>{'date': '2024-02-05 02:16:50', 'modified_ts':...</td>\n",
       "      <td>{'image_baseurl': 'https://img.rnudah.com/imag...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>ads</td>\n",
       "      <td>105554382</td>\n",
       "      <td>{'date': '2024-02-05 02:15:01', 'modified_ts':...</td>\n",
       "      <td>{'image_baseurl': 'https://img.rnudah.com/imag...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>ads</td>\n",
       "      <td>105185585</td>\n",
       "      <td>{'date': '2024-02-05 02:13:06', 'modified_ts':...</td>\n",
       "      <td>{'image_baseurl': 'https://img.rnudah.com/imag...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>ads</td>\n",
       "      <td>104372697</td>\n",
       "      <td>{'date': '2024-02-05 02:12:55', 'modified_ts':...</td>\n",
       "      <td>{'image_baseurl': 'https://img.rnudah.com/imag...</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "  type         id                                         attributes  \\\n",
       "0  ads  105113750  {'date': '2024-02-05 02:16:50', 'modified_ts':...   \n",
       "1  ads  105069635  {'date': '2024-02-05 02:16:50', 'modified_ts':...   \n",
       "2  ads  105554382  {'date': '2024-02-05 02:15:01', 'modified_ts':...   \n",
       "3  ads  105185585  {'date': '2024-02-05 02:13:06', 'modified_ts':...   \n",
       "4  ads  104372697  {'date': '2024-02-05 02:12:55', 'modified_ts':...   \n",
       "\n",
       "                                               links  \n",
       "0  {'image_baseurl': 'https://img.rnudah.com/imag...  \n",
       "1  {'image_baseurl': 'https://img.rnudah.com/imag...  \n",
       "2  {'image_baseurl': 'https://img.rnudah.com/imag...  \n",
       "3  {'image_baseurl': 'https://img.rnudah.com/imag...  \n",
       "4  {'image_baseurl': 'https://img.rnudah.com/imag...  "
      ]
     },
     "execution_count": 3,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "data = pandas.read_json(json_file)\n",
    "# remove duplicates\n",
    "cleaned_data = data[~data.duplicated(subset=\"id\")]\n",
    "cleaned_data.head(5)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>date</th>\n",
       "      <th>modified_ts</th>\n",
       "      <th>building_id</th>\n",
       "      <th>type_name</th>\n",
       "      <th>category_name</th>\n",
       "      <th>list_id</th>\n",
       "      <th>subject</th>\n",
       "      <th>rooms_name</th>\n",
       "      <th>monthly_rent</th>\n",
       "      <th>price_suffix</th>\n",
       "      <th>...</th>\n",
       "      <th>gallery_expiry</th>\n",
       "      <th>highlight</th>\n",
       "      <th>urgent</th>\n",
       "      <th>gallery</th>\n",
       "      <th>has_ps_urgent</th>\n",
       "      <th>has_ps_highlight</th>\n",
       "      <th>has_ps_gallery</th>\n",
       "      <th>roommate_gender_name</th>\n",
       "      <th>bundle</th>\n",
       "      <th>auction_date</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>2024-02-05 02:16:50</td>\n",
       "      <td>1707070610</td>\n",
       "      <td>03d25073-7dd2-4b22-8c09-8e14ac8ce5b8</td>\n",
       "      <td>let</td>\n",
       "      <td>Apartment / Condominium</td>\n",
       "      <td>105113750</td>\n",
       "      <td>Forestville 1000sf MOVEINCONDITION Nr Bayan Le...</td>\n",
       "      <td>3</td>\n",
       "      <td>1700.0</td>\n",
       "      <td>per month</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>2024-02-05 02:16:50</td>\n",
       "      <td>1707070610</td>\n",
       "      <td>fa8a5fa4-fc50-4942-87fe-8f1abe605f1e</td>\n",
       "      <td>let</td>\n",
       "      <td>Apartment / Condominium</td>\n",
       "      <td>105069635</td>\n",
       "      <td>Tropicana Bay 400sf NICELY RENOVATED Nr Bayan ...</td>\n",
       "      <td>1</td>\n",
       "      <td>1700.0</td>\n",
       "      <td>per month</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>2024-02-05 02:15:01</td>\n",
       "      <td>1707070501</td>\n",
       "      <td>NaN</td>\n",
       "      <td>sell</td>\n",
       "      <td>House</td>\n",
       "      <td>105554382</td>\n",
       "      <td>Corner 3S Arcaria Superlink Residences in Tama...</td>\n",
       "      <td>5</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>2024-02-05 02:13:06</td>\n",
       "      <td>1707070386</td>\n",
       "      <td>NaN</td>\n",
       "      <td>sell</td>\n",
       "      <td>House</td>\n",
       "      <td>105185585</td>\n",
       "      <td>Taman Bukit Dahlia Jalan Sejambak Pasir Gudang</td>\n",
       "      <td>5</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>2024-02-05 02:12:55</td>\n",
       "      <td>1707070375</td>\n",
       "      <td>NaN</td>\n",
       "      <td>sell</td>\n",
       "      <td>House</td>\n",
       "      <td>104372697</td>\n",
       "      <td>Taman Pulai Perdana Skudai 4 Bedrooms Ronavated</td>\n",
       "      <td>4</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1094</th>\n",
       "      <td>2024-02-05 11:06:31</td>\n",
       "      <td>1707102391</td>\n",
       "      <td>NaN</td>\n",
       "      <td>sell</td>\n",
       "      <td>Commercial Property</td>\n",
       "      <td>97396828</td>\n",
       "      <td>Wangsa Maju Office Cashback 100k Setapak Ready...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1095</th>\n",
       "      <td>2024-02-05 11:06:23</td>\n",
       "      <td>1707102383</td>\n",
       "      <td>NaN</td>\n",
       "      <td>let</td>\n",
       "      <td>Room</td>\n",
       "      <td>105487627</td>\n",
       "      <td>Master Room Near Hkl, lrt, monorail , Mrt stat...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>1100.0</td>\n",
       "      <td>per month</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>[Male, Female]</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1096</th>\n",
       "      <td>2024-02-05 11:06:19</td>\n",
       "      <td>1707102379</td>\n",
       "      <td>ee9a4ae2-60df-11ee-94fb-5f56d832f7f0</td>\n",
       "      <td>sell</td>\n",
       "      <td>Apartment / Condominium</td>\n",
       "      <td>105557864</td>\n",
       "      <td>FLEXIBLE BOOKING 💥 Apartment Alunan Bayu Seksy...</td>\n",
       "      <td>3</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1097</th>\n",
       "      <td>2024-02-05 11:06:17</td>\n",
       "      <td>1707102377</td>\n",
       "      <td>c8975da3-79fd-4f41-b80c-347d11cec992</td>\n",
       "      <td>sell</td>\n",
       "      <td>Apartment / Condominium</td>\n",
       "      <td>105457700</td>\n",
       "      <td>TINGKAT 2 | CORNER UNIT ⭐️ Pangsapuri Cempaka ...</td>\n",
       "      <td>3</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1098</th>\n",
       "      <td>2024-02-05 11:06:14</td>\n",
       "      <td>1707102374</td>\n",
       "      <td>3138a7a3-6e37-41d4-94fc-294ca6e2b5a4</td>\n",
       "      <td>sell</td>\n",
       "      <td>Apartment / Condominium</td>\n",
       "      <td>101764197</td>\n",
       "      <td>Vina Residency Below Market 45% ready move in ...</td>\n",
       "      <td>5</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>1099 rows × 55 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "                     date  modified_ts                           building_id  \\\n",
       "0     2024-02-05 02:16:50   1707070610  03d25073-7dd2-4b22-8c09-8e14ac8ce5b8   \n",
       "1     2024-02-05 02:16:50   1707070610  fa8a5fa4-fc50-4942-87fe-8f1abe605f1e   \n",
       "2     2024-02-05 02:15:01   1707070501                                   NaN   \n",
       "3     2024-02-05 02:13:06   1707070386                                   NaN   \n",
       "4     2024-02-05 02:12:55   1707070375                                   NaN   \n",
       "...                   ...          ...                                   ...   \n",
       "1094  2024-02-05 11:06:31   1707102391                                   NaN   \n",
       "1095  2024-02-05 11:06:23   1707102383                                   NaN   \n",
       "1096  2024-02-05 11:06:19   1707102379  ee9a4ae2-60df-11ee-94fb-5f56d832f7f0   \n",
       "1097  2024-02-05 11:06:17   1707102377  c8975da3-79fd-4f41-b80c-347d11cec992   \n",
       "1098  2024-02-05 11:06:14   1707102374  3138a7a3-6e37-41d4-94fc-294ca6e2b5a4   \n",
       "\n",
       "     type_name            category_name    list_id  \\\n",
       "0          let  Apartment / Condominium  105113750   \n",
       "1          let  Apartment / Condominium  105069635   \n",
       "2         sell                    House  105554382   \n",
       "3         sell                    House  105185585   \n",
       "4         sell                    House  104372697   \n",
       "...        ...                      ...        ...   \n",
       "1094      sell      Commercial Property   97396828   \n",
       "1095       let                     Room  105487627   \n",
       "1096      sell  Apartment / Condominium  105557864   \n",
       "1097      sell  Apartment / Condominium  105457700   \n",
       "1098      sell  Apartment / Condominium  101764197   \n",
       "\n",
       "                                                subject rooms_name  \\\n",
       "0     Forestville 1000sf MOVEINCONDITION Nr Bayan Le...          3   \n",
       "1     Tropicana Bay 400sf NICELY RENOVATED Nr Bayan ...          1   \n",
       "2     Corner 3S Arcaria Superlink Residences in Tama...          5   \n",
       "3        Taman Bukit Dahlia Jalan Sejambak Pasir Gudang          5   \n",
       "4       Taman Pulai Perdana Skudai 4 Bedrooms Ronavated          4   \n",
       "...                                                 ...        ...   \n",
       "1094  Wangsa Maju Office Cashback 100k Setapak Ready...        NaN   \n",
       "1095  Master Room Near Hkl, lrt, monorail , Mrt stat...        NaN   \n",
       "1096  FLEXIBLE BOOKING 💥 Apartment Alunan Bayu Seksy...          3   \n",
       "1097  TINGKAT 2 | CORNER UNIT ⭐️ Pangsapuri Cempaka ...          3   \n",
       "1098  Vina Residency Below Market 45% ready move in ...          5   \n",
       "\n",
       "      monthly_rent price_suffix  ... gallery_expiry highlight urgent gallery  \\\n",
       "0           1700.0    per month  ...            NaN       NaN    NaN     NaN   \n",
       "1           1700.0    per month  ...            NaN       NaN    NaN     NaN   \n",
       "2              NaN          NaN  ...            NaN       NaN    NaN     NaN   \n",
       "3              NaN          NaN  ...            NaN       NaN    NaN     NaN   \n",
       "4              NaN          NaN  ...            NaN       NaN    NaN     NaN   \n",
       "...            ...          ...  ...            ...       ...    ...     ...   \n",
       "1094           NaN          NaN  ...            NaN       NaN    NaN     NaN   \n",
       "1095        1100.0    per month  ...            NaN       NaN    NaN     NaN   \n",
       "1096           NaN          NaN  ...            NaN       NaN    NaN     NaN   \n",
       "1097           NaN          NaN  ...            NaN       NaN    NaN     NaN   \n",
       "1098           NaN          NaN  ...            NaN       NaN    NaN     NaN   \n",
       "\n",
       "     has_ps_urgent  has_ps_highlight  has_ps_gallery  roommate_gender_name  \\\n",
       "0              NaN               NaN             NaN                   NaN   \n",
       "1              NaN               NaN             NaN                   NaN   \n",
       "2              NaN               NaN             NaN                   NaN   \n",
       "3              NaN               NaN             NaN                   NaN   \n",
       "4              NaN               NaN             NaN                   NaN   \n",
       "...            ...               ...             ...                   ...   \n",
       "1094           NaN               NaN             NaN                   NaN   \n",
       "1095           NaN               NaN             NaN        [Male, Female]   \n",
       "1096           NaN               NaN             NaN                   NaN   \n",
       "1097           NaN               NaN             NaN                   NaN   \n",
       "1098           NaN               NaN             NaN                   NaN   \n",
       "\n",
       "     bundle auction_date  \n",
       "0       NaN          NaN  \n",
       "1       NaN          NaN  \n",
       "2       NaN          NaN  \n",
       "3       NaN          NaN  \n",
       "4       NaN          NaN  \n",
       "...     ...          ...  \n",
       "1094    NaN          NaN  \n",
       "1095    NaN          NaN  \n",
       "1096    NaN          NaN  \n",
       "1097    NaN          NaN  \n",
       "1098    NaN          NaN  \n",
       "\n",
       "[1099 rows x 55 columns]"
      ]
     },
     "execution_count": 4,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "pandas.json_normalize(cleaned_data[\"attributes\"])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>date</th>\n",
       "      <th>modified_ts</th>\n",
       "      <th>building_id</th>\n",
       "      <th>type_name</th>\n",
       "      <th>category_name</th>\n",
       "      <th>list_id</th>\n",
       "      <th>subject</th>\n",
       "      <th>rooms_name</th>\n",
       "      <th>monthly_rent</th>\n",
       "      <th>price_suffix</th>\n",
       "      <th>...</th>\n",
       "      <th>urgent</th>\n",
       "      <th>gallery</th>\n",
       "      <th>has_ps_urgent</th>\n",
       "      <th>has_ps_highlight</th>\n",
       "      <th>has_ps_gallery</th>\n",
       "      <th>roommate_gender_name</th>\n",
       "      <th>bundle</th>\n",
       "      <th>auction_date</th>\n",
       "      <th>image_baseurl</th>\n",
       "      <th>image_grid_baseurl</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>2024-02-05 02:16:50</td>\n",
       "      <td>1707070610</td>\n",
       "      <td>03d25073-7dd2-4b22-8c09-8e14ac8ce5b8</td>\n",
       "      <td>let</td>\n",
       "      <td>Apartment / Condominium</td>\n",
       "      <td>105113750</td>\n",
       "      <td>Forestville 1000sf MOVEINCONDITION Nr Bayan Le...</td>\n",
       "      <td>3</td>\n",
       "      <td>1700.0</td>\n",
       "      <td>per month</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>https://img.rnudah.com/images</td>\n",
       "      <td>https://img.rnudah.com/grids</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>2024-02-05 02:16:50</td>\n",
       "      <td>1707070610</td>\n",
       "      <td>fa8a5fa4-fc50-4942-87fe-8f1abe605f1e</td>\n",
       "      <td>let</td>\n",
       "      <td>Apartment / Condominium</td>\n",
       "      <td>105069635</td>\n",
       "      <td>Tropicana Bay 400sf NICELY RENOVATED Nr Bayan ...</td>\n",
       "      <td>1</td>\n",
       "      <td>1700.0</td>\n",
       "      <td>per month</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>https://img.rnudah.com/images</td>\n",
       "      <td>https://img.rnudah.com/grids</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>2024-02-05 02:15:01</td>\n",
       "      <td>1707070501</td>\n",
       "      <td>NaN</td>\n",
       "      <td>sell</td>\n",
       "      <td>House</td>\n",
       "      <td>105554382</td>\n",
       "      <td>Corner 3S Arcaria Superlink Residences in Tama...</td>\n",
       "      <td>5</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>https://img.rnudah.com/images</td>\n",
       "      <td>https://img.rnudah.com/grids</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>2024-02-05 02:13:06</td>\n",
       "      <td>1707070386</td>\n",
       "      <td>NaN</td>\n",
       "      <td>sell</td>\n",
       "      <td>House</td>\n",
       "      <td>105185585</td>\n",
       "      <td>Taman Bukit Dahlia Jalan Sejambak Pasir Gudang</td>\n",
       "      <td>5</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>https://img.rnudah.com/images</td>\n",
       "      <td>https://img.rnudah.com/grids</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>2024-02-05 02:12:55</td>\n",
       "      <td>1707070375</td>\n",
       "      <td>NaN</td>\n",
       "      <td>sell</td>\n",
       "      <td>House</td>\n",
       "      <td>104372697</td>\n",
       "      <td>Taman Pulai Perdana Skudai 4 Bedrooms Ronavated</td>\n",
       "      <td>4</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>https://img.rnudah.com/images</td>\n",
       "      <td>https://img.rnudah.com/grids</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1094</th>\n",
       "      <td>2024-02-05 11:06:31</td>\n",
       "      <td>1707102391</td>\n",
       "      <td>NaN</td>\n",
       "      <td>sell</td>\n",
       "      <td>Commercial Property</td>\n",
       "      <td>97396828</td>\n",
       "      <td>Wangsa Maju Office Cashback 100k Setapak Ready...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>https://img.rnudah.com/images</td>\n",
       "      <td>https://img.rnudah.com/grids</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1095</th>\n",
       "      <td>2024-02-05 11:06:23</td>\n",
       "      <td>1707102383</td>\n",
       "      <td>NaN</td>\n",
       "      <td>let</td>\n",
       "      <td>Room</td>\n",
       "      <td>105487627</td>\n",
       "      <td>Master Room Near Hkl, lrt, monorail , Mrt stat...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>1100.0</td>\n",
       "      <td>per month</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>[Male, Female]</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>https://img.rnudah.com/images</td>\n",
       "      <td>https://img.rnudah.com/grids</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1096</th>\n",
       "      <td>2024-02-05 11:06:19</td>\n",
       "      <td>1707102379</td>\n",
       "      <td>ee9a4ae2-60df-11ee-94fb-5f56d832f7f0</td>\n",
       "      <td>sell</td>\n",
       "      <td>Apartment / Condominium</td>\n",
       "      <td>105557864</td>\n",
       "      <td>FLEXIBLE BOOKING 💥 Apartment Alunan Bayu Seksy...</td>\n",
       "      <td>3</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>https://img.rnudah.com/images</td>\n",
       "      <td>https://img.rnudah.com/grids</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1097</th>\n",
       "      <td>2024-02-05 11:06:17</td>\n",
       "      <td>1707102377</td>\n",
       "      <td>c8975da3-79fd-4f41-b80c-347d11cec992</td>\n",
       "      <td>sell</td>\n",
       "      <td>Apartment / Condominium</td>\n",
       "      <td>105457700</td>\n",
       "      <td>TINGKAT 2 | CORNER UNIT ⭐️ Pangsapuri Cempaka ...</td>\n",
       "      <td>3</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>https://img.rnudah.com/images</td>\n",
       "      <td>https://img.rnudah.com/grids</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1098</th>\n",
       "      <td>2024-02-05 11:06:14</td>\n",
       "      <td>1707102374</td>\n",
       "      <td>3138a7a3-6e37-41d4-94fc-294ca6e2b5a4</td>\n",
       "      <td>sell</td>\n",
       "      <td>Apartment / Condominium</td>\n",
       "      <td>101764197</td>\n",
       "      <td>Vina Residency Below Market 45% ready move in ...</td>\n",
       "      <td>5</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>https://img.rnudah.com/images</td>\n",
       "      <td>https://img.rnudah.com/grids</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>1099 rows × 57 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "                     date  modified_ts                           building_id  \\\n",
       "0     2024-02-05 02:16:50   1707070610  03d25073-7dd2-4b22-8c09-8e14ac8ce5b8   \n",
       "1     2024-02-05 02:16:50   1707070610  fa8a5fa4-fc50-4942-87fe-8f1abe605f1e   \n",
       "2     2024-02-05 02:15:01   1707070501                                   NaN   \n",
       "3     2024-02-05 02:13:06   1707070386                                   NaN   \n",
       "4     2024-02-05 02:12:55   1707070375                                   NaN   \n",
       "...                   ...          ...                                   ...   \n",
       "1094  2024-02-05 11:06:31   1707102391                                   NaN   \n",
       "1095  2024-02-05 11:06:23   1707102383                                   NaN   \n",
       "1096  2024-02-05 11:06:19   1707102379  ee9a4ae2-60df-11ee-94fb-5f56d832f7f0   \n",
       "1097  2024-02-05 11:06:17   1707102377  c8975da3-79fd-4f41-b80c-347d11cec992   \n",
       "1098  2024-02-05 11:06:14   1707102374  3138a7a3-6e37-41d4-94fc-294ca6e2b5a4   \n",
       "\n",
       "     type_name            category_name    list_id  \\\n",
       "0          let  Apartment / Condominium  105113750   \n",
       "1          let  Apartment / Condominium  105069635   \n",
       "2         sell                    House  105554382   \n",
       "3         sell                    House  105185585   \n",
       "4         sell                    House  104372697   \n",
       "...        ...                      ...        ...   \n",
       "1094      sell      Commercial Property   97396828   \n",
       "1095       let                     Room  105487627   \n",
       "1096      sell  Apartment / Condominium  105557864   \n",
       "1097      sell  Apartment / Condominium  105457700   \n",
       "1098      sell  Apartment / Condominium  101764197   \n",
       "\n",
       "                                                subject rooms_name  \\\n",
       "0     Forestville 1000sf MOVEINCONDITION Nr Bayan Le...          3   \n",
       "1     Tropicana Bay 400sf NICELY RENOVATED Nr Bayan ...          1   \n",
       "2     Corner 3S Arcaria Superlink Residences in Tama...          5   \n",
       "3        Taman Bukit Dahlia Jalan Sejambak Pasir Gudang          5   \n",
       "4       Taman Pulai Perdana Skudai 4 Bedrooms Ronavated          4   \n",
       "...                                                 ...        ...   \n",
       "1094  Wangsa Maju Office Cashback 100k Setapak Ready...        NaN   \n",
       "1095  Master Room Near Hkl, lrt, monorail , Mrt stat...        NaN   \n",
       "1096  FLEXIBLE BOOKING 💥 Apartment Alunan Bayu Seksy...          3   \n",
       "1097  TINGKAT 2 | CORNER UNIT ⭐️ Pangsapuri Cempaka ...          3   \n",
       "1098  Vina Residency Below Market 45% ready move in ...          5   \n",
       "\n",
       "      monthly_rent price_suffix  ... urgent gallery has_ps_urgent  \\\n",
       "0           1700.0    per month  ...    NaN     NaN           NaN   \n",
       "1           1700.0    per month  ...    NaN     NaN           NaN   \n",
       "2              NaN          NaN  ...    NaN     NaN           NaN   \n",
       "3              NaN          NaN  ...    NaN     NaN           NaN   \n",
       "4              NaN          NaN  ...    NaN     NaN           NaN   \n",
       "...            ...          ...  ...    ...     ...           ...   \n",
       "1094           NaN          NaN  ...    NaN     NaN           NaN   \n",
       "1095        1100.0    per month  ...    NaN     NaN           NaN   \n",
       "1096           NaN          NaN  ...    NaN     NaN           NaN   \n",
       "1097           NaN          NaN  ...    NaN     NaN           NaN   \n",
       "1098           NaN          NaN  ...    NaN     NaN           NaN   \n",
       "\n",
       "     has_ps_highlight has_ps_gallery  roommate_gender_name  bundle  \\\n",
       "0                 NaN            NaN                   NaN     NaN   \n",
       "1                 NaN            NaN                   NaN     NaN   \n",
       "2                 NaN            NaN                   NaN     NaN   \n",
       "3                 NaN            NaN                   NaN     NaN   \n",
       "4                 NaN            NaN                   NaN     NaN   \n",
       "...               ...            ...                   ...     ...   \n",
       "1094              NaN            NaN                   NaN     NaN   \n",
       "1095              NaN            NaN        [Male, Female]     NaN   \n",
       "1096              NaN            NaN                   NaN     NaN   \n",
       "1097              NaN            NaN                   NaN     NaN   \n",
       "1098              NaN            NaN                   NaN     NaN   \n",
       "\n",
       "      auction_date                  image_baseurl  \\\n",
       "0              NaN  https://img.rnudah.com/images   \n",
       "1              NaN  https://img.rnudah.com/images   \n",
       "2              NaN  https://img.rnudah.com/images   \n",
       "3              NaN  https://img.rnudah.com/images   \n",
       "4              NaN  https://img.rnudah.com/images   \n",
       "...            ...                            ...   \n",
       "1094           NaN  https://img.rnudah.com/images   \n",
       "1095           NaN  https://img.rnudah.com/images   \n",
       "1096           NaN  https://img.rnudah.com/images   \n",
       "1097           NaN  https://img.rnudah.com/images   \n",
       "1098           NaN  https://img.rnudah.com/images   \n",
       "\n",
       "                image_grid_baseurl  \n",
       "0     https://img.rnudah.com/grids  \n",
       "1     https://img.rnudah.com/grids  \n",
       "2     https://img.rnudah.com/grids  \n",
       "3     https://img.rnudah.com/grids  \n",
       "4     https://img.rnudah.com/grids  \n",
       "...                            ...  \n",
       "1094  https://img.rnudah.com/grids  \n",
       "1095  https://img.rnudah.com/grids  \n",
       "1096  https://img.rnudah.com/grids  \n",
       "1097  https://img.rnudah.com/grids  \n",
       "1098  https://img.rnudah.com/grids  \n",
       "\n",
       "[1099 rows x 57 columns]"
      ]
     },
     "execution_count": 5,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "merged_data = pandas.concat([pandas.json_normalize(cleaned_data[\"attributes\"]), \n",
    "                            pandas.json_normalize(cleaned_data[\"links\"])], axis=1,\n",
    "                            )\n",
    "merged_data"
   ]
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "test",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.9.16"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 2
}
